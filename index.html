<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AppliCours - Créateur de cours interactifs</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 250px 1fr;
            grid-template-rows: auto 1fr auto;
            gap: 20px;
            grid-template-areas: 
                "header header"
                "sidebar main"
                "footer footer";
            min-height: 100vh;
        }
        
        header {
            grid-area: header;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .app-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .app-title h1 {
            font-size: 1.8rem;
            margin: 0;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
        }
        
        .btn-secondary {
            background: #2ecc71;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #27ae60;
        }
        
        .btn-tertiary {
            background: #9b59b6;
            color: white;
        }
        
        .btn-tertiary:hover {
            background: #8e44ad;
        }
        
        .btn-warning {
            background: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .sidebar {
            grid-area: sidebar;
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }
        
        .sidebar h3 {
            margin: 20px 0 10px 0;
            padding-bottom: 5px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar ul {
            list-style: none;
        }
        
        .sidebar li {
            margin: 10px 0;
        }
        
        .sidebar a {
            color: #ecf0f1;
            text-decoration: none;
            display: block;
            padding: 8px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .sidebar a:hover {
            background: #3498db;
        }
        
        .main-content {
            grid-area: main;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 30px;
            overflow-y: auto;
        }
        
        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: 100%;
        }
        
        .editor-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
        }
        
        .preview-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            position: relative;
        }
        
        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .preview-actions {
            display: flex;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }
        
        .content-type-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .content-type-btn {
            padding: 8px 15px;
            background: #e0e0e0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .content-type-btn.active {
            background: #3498db;
            color: white;
        }
        
        .media-upload {
            border: 2px dashed #3498db;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .media-upload:hover {
            background: #e8f4fc;
        }
        
        .youtube-link {
            margin: 15px 0;
            display: flex;
            gap: 10px;
        }
        
        .youtube-link input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .youtube-link button {
            padding: 10px 15px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .media-preview {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .media-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .media-item img, .media-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .media-item audio {
            width: 100%;
            margin-top: 35px;
        }
        
        .youtube-thumbnail {
            width: 100%;
            height: 100%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .youtube-thumbnail i {
            font-size: 2rem;
            color: #e74c3c;
        }
        
        .remove-media {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #e74c3c;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }
        
        /* Éditeur de texte enrichi */
        .rich-text-editor {
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            background: #f0f0f0;
            border-bottom: 1px solid #ddd;
        }
        
        .toolbar button {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .toolbar button:hover {
            background: #e0e0e0;
        }
        
        .toolbar button.active {
            background: #3498db;
            color: white;
        }
        
        .color-btn {
            position: relative;
        }
        
        .color-options {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            display: none;
            flex-direction: column;
            gap: 5px;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .color-option {
            width: 24px;
            height: 24px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .color-red { background: #ff4d4d; }
        .color-blue { background: #3498db; }
        .color-green { background: #2ecc71; }
        
        .color-btn:hover .color-options {
            display: flex;
        }
        
        .editor-content {
            min-height: 200px;
            padding: 15px;
            outline: none;
            overflow-y: auto;
            background: white;
        }
        
        .editor-content:focus {
            border-color: #3498db;
        }
        
        /* Styles pour le texte formaté */
        .text-red { color: #ff4d4d; }
        .text-blue { color: #3498db; }
        .text-green { color: #2ecc71; }
        .text-bold { font-weight: bold; }
        .text-italic { font-style: italic; }
        .text-underline { text-decoration: underline; }
        .text-strike { text-decoration: line-through; }
        
        .chapter {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .chapter h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chapter-content {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .prerequisites {
            background: #ffeaa7;
            border-left: 5px solid #fdcb6e;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .prerequisites-check {
            background: #ffebcd;
            border-left: 5px solid #ffa500;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .problem-situation {
            background: #ffeaa7;
            border-left: 5px solid #fdcb6e;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .situation-solution {
            background: #d8f8ff;
            border-left: 5px solid #81ecec;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .general-objectives {
            background: #e8f4fc;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .specific-objectives {
            background: #e8f4fc;
            border-left: 5px solid #2980b9;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .skills {
            background: #e8f4fc;
            border-left: 5px solid #1c6ea4;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .lesson-theme {
            background: #f4ecf7;
            border-left: 5px solid #9b59b6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .lesson-title {
            background: #f4ecf7;
            border-left: 5px solid #8e44ad;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .vocabulary {
            background: #e7f9ed;
            border-left: 5px solid #2ecc71;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .definition {
            background: #e8f4fc;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .example {
            background: #e7f9ed;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 5px solid #2ecc71;
        }
        
        .theorem {
            background: #e8f4fc;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .demonstration {
            background: #fef9e7;
            border-left: 5px solid #f1c40f;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .proof {
            background: #fef9e7;
            border-left: 5px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .property {
            background: #e8f4fc;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .reciprocal {
            background: #e8f4fc;
            border-left: 5px solid #2980b9;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .method-points {
            background: #fdebd0;
            border-left: 5px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .remark {
            background: #fef9e7;
            border-left: 5px solid #f1c40f;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .activity {
            background: #e7f9ed;
            border-left: 5px solid #2ecc71;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .activity-solution {
            background: #f4ecf7;
            border-left: 5px solid #9b59b6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .exercise {
            background: #fef9e7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 5px solid #f1c40f;
        }
        
        .exercise-solution {
            background: #f4ecf7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 5px solid #9b59b6;
        }
        
        .solution {
            background: #f4ecf7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 5px solid #9b59b6;
            display: none;
        }
        
        .toggle-solution {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }
        
        .toggle-solution:hover {
            background: #8e44ad;
        }
        
        .summary {
            background: #fdebd0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
        }
        
        .homework {
            background: #e8d6ff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #8e44ad;
        }
        
        .formula {
            font-family: 'Cambria Math', serif;
            text-align: center;
            font-size: 1.2rem;
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px dashed #3498db;
        }
        
        .geometry-demo {
            width: 100%;
            height: 250px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .triangle {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto;
        }
        
        .triangle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 173px solid #3498db;
        }
        
        .triangle-labels {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .label {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.9rem;
        }
        
        footer {
            grid-area: footer;
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .media-controls {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .media-btn {
            padding: 8px 12px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Styles pour l'exportation */
        .export-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .export-modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .export-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .export-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .export-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* Modal YouTube */
        .youtube-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .youtube-modal-content {
            width: 80%;
            max-width: 800px;
            background: #000;
            position: relative;
        }
        
        .youtube-modal iframe {
            width: 100%;
            height: 450px;
            border: none;
        }
        
        .close-youtube {
            position: absolute;
            top: -40px;
            right: 0;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }
        
        /* Informations de l'enseignant */
        .teacher-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }
        
        .teacher-info h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Modal plein écran */
        .fullscreen-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 3000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .fullscreen-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
        }
        
        .fullscreen-content {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        @media (max-width: 1100px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .app-container {
                grid-template-columns: 1fr;
                grid-template-areas: 
                    "header"
                    "main"
                    "sidebar"
                    "footer";
            }
            
            .sidebar {
                order: 3;
            }
            
            .main-content {
                order: 2;
            }
            
            footer {
                order: 4;
            }
            
            .content-type-selector {
                flex-direction: column;
            }
            
            .toolbar {
                justify-content: center;
            }
            
            .header-actions {
                flex-direction: column;
                align-items: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <div class="app-title">
                <i class="fas fa-chalkboard-teacher fa-2x"></i>
                <h1>AppliCours - Créateur de cours interactifs</h1>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" id="new-course">
                    <i class="fas fa-plus"></i> Nouveau cours
                </button>
                <button class="btn btn-secondary" id="save-course">
                    <i class="fas fa-save"></i> Sauvegarder
                </button>
                <button class="btn btn-warning" id="load-course">
                    <i class="fas fa-folder-open"></i> Charger
                </button>
                <button class="btn btn-tertiary" id="export-json">
                    <i class="fas fa-file-export"></i> Exporter JSON
                </button>
                <button class="btn btn-tertiary" id="import-json">
                    <i class="fas fa-file-import"></i> Importer JSON
                </button>
            </div>
        </header>
        
        <div class="sidebar">
            <h3><i class="fas fa-book"></i> Chapitres</h3>
            <ul id="chapters-list">
                <li><a href="#" data-chapter="situation-probleme"><i class="fas fa-angle-right"></i> Situation Problème</a></li>
                <li><a href="#" data-chapter="prerequis"><i class="fas fa-angle-right"></i> Prérequis</a></li>
                <li><a href="#" data-chapter="activite"><i class="fas fa-angle-right"></i> Activité</a></li>
                <li><a href="#" data-chapter="definitions"><i class="fas fa-angle-right"></i> Définitions</a></li>
                <li><a href="#" data-chapter="pythagore"><i class="fas fa-angle-right"></i> Théorème de Pythagore</a></li>
                <li><a href="#" data-chapter="reciproque-pythagore"><i class="fas fa-angle-right"></i> Réciproque de Pythagore</a></li>
                <li><a href="#" data-chapter="thales"><i class="fas fa-angle-right"></i> Théorème de Thalès</a></li>
                <li><a href="#" data-chapter="reciproque-thales"><i class="fas fa-angle-right"></i> Réciproque de Thalès</a></li>
                <li><a href="#" data-chapter="exercices"><i class="fas fa-angle-right"></i> Exercices</a></li>
                <li><a href="#" data-chapter="resume"><i class="fas fa-angle-right"></i> Résumé</a></li>
                <li><a href="#" data-chapter="devoir-maison"><i class="fas fa-angle-right"></i> Devoir Maison</a></li>
            </ul>
            
            <h3><i class="fas fa-cog"></i> Outils</h3>
            <ul>
                <li><a href="#" id="add-chapter"><i class="fas fa-plus-circle"></i> Ajouter un chapitre</a></li>
                <li><a href="#" id="add-prerequisites"><i class="fas fa-list-check"></i> Ajouter des prérequis</a></li>
                <li><a href="#" id="add-prerequisites-check"><i class="fas fa-check-double"></i> Vérification des prérequis</a></li>
                <li><a href="#" id="add-problem-situation"><i class="fas fa-puzzle-piece"></i> Situation problème</a></li>
                <li><a href="#" id="add-solution-situation"><i class="fas fa-lightbulb"></i> Solution situation problème</a></li>
                <li><a href="#" id="add-general-objectives"><i class="fas fa-bullseye"></i> Objectifs généraux</a></li>
                <li><a href="#" id="add-specific-objectives"><i class="fas fa-bullseye"></i> Objectifs spécifiques</a></li>
                <li><a href="#" id="add-skills"><i class="fas fa-graduation-cap"></i> Compétences</a></li>
                <li><a href="#" id="add-lesson-theme"><i class="fas fa-palette"></i> Thème de la leçon</a></li>
                <li><a href="#" id="add-lesson-title"><i class="fas fa-heading"></i> Titre de la leçon</a></li>
                <li><a href="#" id="add-vocabulary"><i class="fas fa-book"></i> Vocabulaire</a></li>
                <li><a href="#" id="add-definition"><i class="fas fa-book-open"></i> Définition</a></li>
                <li><a href="#" id="add-example"><i class="fas fa-lightbulb"></i> Exemple</a></li>
                <li><a href="#" id="add-theorem"><i class="fas fa-square-root-alt"></i> Théorème</a></li>
                <li><a href="#" id="add-demonstration"><i class="fas fa-chalkboard-teacher"></i> Démonstration</a></li>
                <li><a href="#" id="add-proof"><i class="fas fa-tasks"></i> Preuve</a></li>
                <li><a href="#" id="add-property"><i class="fas fa-shapes"></i> Propriété</a></li>
                <li><a href="#" id="add-reciprocal"><i class="fas fa-exchange-alt"></i> Réciproque de propriété</a></li>
                <li><a href="#" id="add-method-points"><i class="fas fa-clipboard-list"></i> Points méthode</a></li>
                <li><a href="#" id="add-remark"><i class="fas fa-comment"></i> Remarque</a></li>
                <li><a href="#" id="add-application-exercise"><i class="fas fa-pencil-alt"></i> Exercice d'application</a></li>
                <li><a href="#" id="add-exercise-solution"><i class="fas fa-check-double"></i> Solution exercice</a></li>
                <li><a href="#" id="add-activity"><i class="fas fa-plus-circle"></i> Ajouter une activité</a></li>
                <li><a href="#" id="add-media"><i class="fas fa-plus-circle"></i> Ajouter un média</a></li>
            </ul>
            
            <h3><i class="fas fa-download"></i> Export</h3>
            <ul>
                <li><a href="#" id="export-pdf"><i class="fas fa-file-pdf"></i> Exporter en PDF</a></li>
                <li><a href="#" id="export-html"><i class="fas fa-file-code"></i> Exporter en HTML</a></li>
            </ul>
        </div>
        
        <div class="main-content">
            <div class="teacher-info">
                <h3><i class="fas fa-user-graduate"></i> Informations de l'enseignant</h3>
                <div class="info-grid">
                    <div class="form-group">
                        <label for="school-name">Nom de l'établissement</label>
                        <input type="text" id="school-name" class="form-control" value="Lycée NIAMTOUGOU">
                    </div>
                    <div class="form-group">
                        <label for="inspection">Inspection (IESG)</label>
                        <input type="text" id="inspection" class="form-control" value="IESG NIAMTOUGOU">
                    </div>
                    <div class="form-group">
                        <label for="dre">Direction Régionale (DRE)</label>
                        <input type="text" id="dre" class="form-control" value="DRE KARA">
                    </div>
                    <div class="form-group">
                        <label for="teacher-name">Nom de l'enseignant</label>
                        <input type="text" id="teacher-name" class="form-control" value="Mr KOLA M.Essohouna">
                    </div>
                    <div class="form-group">
                        <label for="school-year">Année scolaire</label>
                        <input type="text" id="school-year" class="form-control" value="2024-2025">
                    </div>
                    <div class="form-group">
                        <label for="class">Classe</label>
                        <input type="text" id="class" class="form-control" value="Seconde CD">
                    </div>
                    <div class="form-group">
                        <label for="boys-count">Effectif garçons</label>
                        <input type="number" id="boys-count" class="form-control" value="25">
                    </div>
                    <div class="form-group">
                        <label for="girls-count">Effectif filles</label>
                        <input type="number" id="girls-count" class="form-control" value="20">
                    </div>
                    <div class="form-group">
                        <label for="teacher-phone">Contact WhatsApp</label>
                        <input type="text" id="teacher-phone" class="form-control" value="+228 92 87 16 05">
                    </div>
                    <div class="form-group">
                        <label for="teacher-email">Adresse email</label>
                        <input type="email" id="teacher-email" class="form-control" value="jeanskodoc22@gmail.com">
                    </div>
                </div>
            </div>
            
            <div class="editor-container">
                <div class="editor-panel">
                    <h2><i class="fas fa-edit"></i> Éditeur de cours</h2>
                    
                    <div class="form-group">
                        <label for="course-title">Titre du cours</label>
                        <input type="text" id="course-title" class="form-control" value="Théorèmes de Pythagore et de Thalès">
                    </div>
                    
                    <div class="form-group">
                        <label for="course-description">Description</label>
                        <textarea id="course-description" class="form-control">Cours complet de mathématiques pour la classe de Seconde</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="chapter-select">Chapitre</label>
                        <select id="chapter-select" class="form-control">
                            <option value="situation-probleme">Situation Problème</option>
                            <option value="prerequis">Prérequis</option>
                            <option value="activite">Activité</option>
                            <option value="definitions">Définitions</option>
                            <option value="pythagore">Théorème de Pythagore</option>
                            <option value="reciproque-pythagore">Réciproque de Pythagore</option>
                            <option value="thales">Théorème de Thalès</option>
                            <option value="reciproque-thales">Réciproque de Thalès</option>
                            <option value="exercices">Exercices</option>
                            <option value="resume">Résumé</option>
                            <option value="devoir-maison">Devoir Maison</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="chapter-title">Titre du chapitre</label>
                        <input type="text" id="chapter-title" class="form-control" value="Situation Problème">
                    </div>
                    
                    <div class="form-group">
                        <label>Type de contenu</label>
                        <div class="content-type-selector">
                            <button class="content-type-btn active" data-type="problem-situation">
                                <i class="fas fa-puzzle-piece"></i> Situation problème
                            </button>
                            <button class="content-type-btn" data-type="situation-solution">
                                <i class="fas fa-lightbulb"></i> Solution situation
                            </button>
                            <button class="content-type-btn" data-type="prerequisites">
                                <i class="fas fa-list-check"></i> Prérequis
                            </button>
                            <button class="content-type-btn" data-type="prerequisites-check">
                                <i class="fas fa-check-double"></i> Vérif. prérequis
                            </button>
                            <button class="content-type-btn" data-type="general-objectives">
                                <i class="fas fa-bullseye"></i> Objectifs généraux
                            </button>
                            <button class="content-type-btn" data-type="specific-objectives">
                                <i class="fas fa-bullseye"></i> Objectifs spécifiques
                            </button>
                            <button class="content-type-btn" data-type="skills">
                                <i class="fas fa-graduation-cap"></i> Compétences
                            </button>
                            <button class="content-type-btn" data-type="lesson-theme">
                                <i class="fas fa-palette"></i> Thème leçon
                            </button>
                            <button class="content-type-btn" data-type="lesson-title">
                                <i class="fas fa-heading"></i> Titre leçon
                            </button>
                            <button class="content-type-btn" data-type="vocabulary">
                                <i class="fas fa-book"></i> Vocabulaire
                            </button>
                            <button class="content-type-btn" data-type="definition">
                                <i class="fas fa-book-open"></i> Définition
                            </button>
                            <button class="content-type-btn" data-type="example">
                                <i class="fas fa-lightbulb"></i> Exemple
                            </button>
                            <button class="content-type-btn" data-type="theorem">
                                <i class="fas fa-square-root-alt"></i> Théorème
                            </button>
                            <button class="content-type-btn" data-type="demonstration">
                                <i class="fas fa-chalkboard-teacher"></i> Démonstration
                            </button>
                            <button class="content-type-btn" data-type="proof">
                                <i class="fas fa-tasks"></i> Preuve
                            </button>
                            <button class="content-type-btn" data-type="property">
                                <i class="fas fa-shapes"></i> Propriété
                            </button>
                            <button class="content-type-btn" data-type="reciprocal">
                                <i class="fas fa-exchange-alt"></i> Réciproque
                            </button>
                            <button class="content-type-btn" data-type="method-points">
                                <i class="fas fa-clipboard-list"></i> Points méthode
                            </button>
                            <button class="content-type-btn" data-type="remark">
                                <i class="fas fa-comment"></i> Remarque
                            </button>
                            <button class="content-type-btn" data-type="activity">
                                <i class="fas fa-tasks"></i> Activité
                            </button>
                            <button class="content-type-btn" data-type="activity-solution">
                                <i class="fas fa-check-circle"></i> Solution activité
                            </button>
                            <button class="content-type-btn" data-type="exercise">
                                <i class="fas fa-pencil-alt"></i> Exercice
                            </button>
                            <button class="content-type-btn" data-type="exercise-solution">
                                <i class="fas fa-check-double"></i> Solution exercice
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="chapter-content">Contenu</label>
                        <div class="rich-text-editor">
                            <div class="toolbar">
                                <button id="bold-btn" title="Gras"><i class="fas fa-bold"></i></button>
                                <button id="italic-btn" title="Italique"><i class="fas fa-italic"></i></button>
                                <button id="underline-btn" title="Souligné"><i class="fas fa-underline"></i></button>
                                <button id="strike-btn" title="Barré"><i class="fas fa-strikethrough"></i></button>
                                <div class="color-btn">
                                    <button title="Couleur du texte"><i class="fas fa-palette"></i></button>
                                    <div class="color-options">
                                        <button class="color-option color-red" data-color="red" title="Rouge"></button>
                                        <button class="color-option color-blue" data-color="blue" title="Bleu"></button>
                                        <button class="color-option color-green" data-color="green" title="Vert"></button>
                                    </div>
                                </div>
                                <button id="clear-format" title="Effacer le formatage"><i class="fas fa-eraser"></i></button>
                            </div>
                            <div id="editor-content" class="editor-content" contenteditable="true">
                                Un paysagiste doit créer une allée rectiligne traversant un parc triangulaire. Il souhaite que cette allée soit parallèle à l'un des côtés du parc. Le parc a la forme d'un triangle ABC avec AB = 50 m, AC = 80 m et BC = 100 m.

                                L'allée doit couper les côtés [AB] et [AC] respectivement en M et N tels que AM = 20 m.

                                Comment le paysagiste peut-il déterminer la position exacte du point N sur le côté [AC] pour que l'allée (MN) soit parallèle au côté [BC] ?
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Ajouter des médias</label>
                        <div class="youtube-link">
                            <input type="text" id="youtube-url" placeholder="Coller le lien YouTube ici" class="form-control">
                            <button id="add-youtube"><i class="fab fa-youtube"></i> Ajouter</button>
                        </div>
                        
                        <div class="media-upload" id="media-upload-area">
                            <i class="fas fa-cloud-upload-alt fa-2x"></i>
                            <p>Glissez-déposez des fichiers ici ou cliquez pour parcourir</p>
                            <input type="file" id="media-file-input" multiple style="display: none;">
                        </div>
                        
                        <div class="media-preview" id="media-preview">
                            <!-- Les médias ajoutés apparaîtront ici -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button class="btn btn-primary" id="update-chapter">
                            <i class="fas fa-sync-alt"></i> Mettre à jour le chapitre
                        </button>
                    </div>
                </div>
                
                <div class="preview-panel">
                    <div class="preview-header">
                        <h2><i class="fas fa-eye"></i> Aperçu du cours</h2>
                        <div class="preview-actions">
                            <button class="btn btn-primary" id="fullscreen-preview">
                                <i class="fas fa-expand"></i> Plein écran
                            </button>
                        </div>
                    </div>
                    
                    <div id="course-preview">
                        <!-- Contenu généré dynamiquement -->
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>AppliCours - Créateur de cours interactifs</p>
            <p>© 2025 - Tous droits réservés</p>
        </footer>
    </div>

    <!-- Modal d'exportation -->
    <div class="export-modal" id="export-modal">
        <div class="export-modal-content">
            <h2><i class="fas fa-download"></i> Options d'exportation</h2>
            
            <div class="export-options">
                <div class="export-option">
                    <input type="checkbox" id="export-title" checked>
                    <label for="export-title">Inclure le titre du cours</label>
                </div>
                
                <div class="export-option">
                    <input type="checkbox" id="export-description" checked>
                    <label for="export-description">Inclure la description</label>
                </div>
                
                <div class="export-option">
                    <input type="checkbox" id="export-all-chapters" checked>
                    <label for="export-all-chapters">Exporter tous les chapitres</label>
                </div>
                
                <div class="export-option" id="chapter-selection" style="display: none;">
                    <label for="export-chapters">Sélectionner les chapitres:</label>
                    <select id="export-chapters" multiple style="width: 100%; margin-top: 5px;">
                        <option value="situation-probleme" selected>Situation Problème</option>
                        <option value="prerequis" selected>Prérequis</option>
                        <option value="activite" selected>Activité</option>
                        <option value="definitions" selected>Définitions</option>
                        <option value="pythagore" selected>Théorème de Pythagore</option>
                        <option value="reciproque-pythagore" selected>Réciproque de Pythagore</option>
                        <option value="thales" selected>Théorème de Thalès</option>
                        <option value="reciproque-thales" selected>Réciproque de Thalès</option>
                        <option value="exercices" selected>Exercices</option>
                        <option value="resume" selected>Résumé</option>
                        <option value="devoir-maison" selected>Devoir Maison</option>
                    </select>
                </div>
            </div>
            
            <div class="export-actions">
                <button class="btn btn-tertiary" id="cancel-export">Annuler</button>
                <button class="btn btn-primary" id="confirm-export">Exporter</button>
            </div>
        </div>
    </div>

    <!-- Modal YouTube -->
    <div class="youtube-modal" id="youtube-modal">
        <div class="youtube-modal-content">
            <span class="close-youtube" id="close-youtube">&times;</span>
            <iframe id="youtube-player" src="" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>

    <!-- Modal plein écran pour l'aperçu -->
    <div class="fullscreen-modal" id="fullscreen-modal">
        <div class="fullscreen-header">
            <h2>Aperçu du cours en plein écran</h2>
            <button class="btn btn-danger" id="close-fullscreen">
                <i class="fas fa-times"></i> Fermer
            </button>
        </div>
        <div class="fullscreen-content" id="fullscreen-content">
            <!-- Le contenu de l'aperçu sera inséré ici -->
        </div>
    </div>

    <script>
        // Fonctionnalités de base
        document.addEventListener('DOMContentLoaded', function() {
            // Données du cours
            let courseData = {
                title: "Théorèmes de Pythagore et de Thalès",
                description: "Cours complet de mathématiques pour la classe de Seconde",
                teacherInfo: {
                    schoolName: "Lycée Moderne",
                    inspection: "IESG Abidjan",
                    dre: "DRE Abidjan",
                    teacherName: "M. Koné Abdoul",
                    schoolYear: "2024-2025",
                    class: "Seconde C",
                    boysCount: 25,
                    girlsCount: 20,
                    teacherPhone: "+225 07 08 09 10 11",
                    teacherEmail: "kone.abdoul@lyceemoderne.ci"
                },
                chapters: {
                    "situation-probleme": {
                        title: "Situation Problème",
                        content: {
                            "problem-situation": "Un paysagiste doit créer une allée rectiligne traversant un parc triangulaire. Il souhaite que cette allée soit parallèle à l'un des côtés du parc. Le parc a la forme d'un triangle ABC avec AB = 50 m, AC = 80 m et BC = 100 m.\n\nL'allée doit couper les côtés [AB] et [AC] respectivement en M et N tels que AM = 20 m.\n\nComment le paysagiste peut-il déterminer la position exacte du point N sur le côté [AC] pour que l'allée (MN) soit parallèle au côté [BC] ?",
                            "situation-solution": "Pour résoudre ce problème, le paysagiste peut utiliser le théorème de Thalès qui établit des relations de proportionnalité dans une configuration où des droites sont parallèles.\n\nSi (MN) est parallèle à (BC), alors d'après le théorème de Thalès, on a :\nAM/AB = AN/AC = MN/BC\n\nAvec AB = 50 m, AC = 80 m, AM = 20 m, on peut calculer AN = (AM × AC)/AB = (20 × 80)/50 = 32 m.\n\nAinsi, le point N doit être placé à 32 m du point A sur le côté [AC] pour que (MN) soit parallèle à (BC)."
                        },
                        media: []
                    },
                    "prerequis": {
                        title: "Prérequis",
                        content: {
                            "prerequisites": "- Connaître les propriétés des triangles\n- Savoir calculer des proportions\n- Maîtriser les opérations de base\n- Connaître les propriétés des droites parallèles"
                        },
                        media: []
                    },
                    "activite": {
                        title: "Activité Pédagogique",
                        content: {
                            "activity": "En groupe de 3 ou 4, mesurez les dimensions de différents triangles rectangles dans la salle de classe et vérifiez si elles respectent le théorème de Pythagore.\n\nMatériel nécessaire :\n- Ruban à mesurer\n- Rapporteur\n- Calculatrice\n- Feuille de calcul",
                            "activity-solution": "Solution de l'activité :\n\n1. Mesurez les côtés de plusieurs triangles rectangles\n2. Vérifiez que pour chaque triangle, le carré de l'hypoténuse est égal à la somme des carrés des deux autres côtés\n3. Notez vos observations et tirez une conclusion"
                        },
                        media: []
                    },
                    "definitions": {
                        title: "Définitions",
                        content: {
                            "definition": "- Triangle rectangle: Un triangle qui possède un angle droit. Le côté opposé à l'angle droit est appelé hypoténuse.\n- Hypoténuse: Dans un triangle rectangle, l'hypoténuse est le côté opposé à l'angle droit. C'est le plus long côté du triangle.\n- Configuration de Thalès: Figure géométrique composée de deux droites sécantes et de deux droites parallèles, permettant d'établir des relations de proportionnalité."
                        },
                        media: []
                    },
                    "pythagore": {
                        title: "Théorème de Pythagore",
                        content: {
                            "theorem": "Si un triangle est rectangle, alors le carré de la longueur de l'hypoténuse est égal à la somme des carrés des longueurs des deux autres côtés.",
                            "formula": "Si ABC est un triangle rectangle en A, alors : BC² = AB² + AC²",
                            "example": "Soit un triangle ABC rectangle en A avec AB = 3 cm et AC = 4 cm.\n\nCalculons BC :\nBC² = AB² + AC² = 3² + 4² = 9 + 16 = 25\nDonc BC = √25 = 5 cm"
                        },
                        media: []
                    },
                    "reciproque-pythagore": {
                        title: "Réciproque de Pythagore",
                        content: {
                            "theorem": "Si dans un triangle, le carré de la longueur du plus grand côté est égal à la somme des carrés des longueurs des deux autres côtés, alors ce triangle est rectangle.",
                            "example": "Soit un triangle ABC avec AB = 5 cm, AC = 12 cm et BC = 13 cm.\n\nVérifions s'il est rectangle :\nOn calcule BC² = 13² = 169\nOn calcule AB² + AC² = 5² + 12² = 25 + 144 = 169\n\nComme BC² = AB² + AC², d'après la réciproque du théorème de Pythagore, le triangle ABC est rectangle en A."
                        },
                        media: []
                    },
                    "thales": {
                        title: "Théorème de Thalès",
                        content: {
                            "theorem": "Soit deux droites sécantes en un point A, et deux points B et M sur l'une, et C et N sur l'autre.\n\nSi les droites (BC) et (MN) sont parallèles, alors les triangles ABC et AMN formen une configuration de Thalès et on a : AB/AM = AC/AN = BC/MN",
                            "example": "Soit un triangle ABC et une droite parallèle à (BC) qui coupe (AB) en M et (AC) en N.\n\nOn donne : AB = 10 cm, AM = 4 cm, AC = 8 cm.\n\nCalculons AN :\nD'après le théorème de Thalès : AM/AB = AN/AC\nDonc 4/10 = AN/8 ⇒ AN = (4 × 8)/10 = 32/10 = 3,2 cm"
                        },
                        media: []
                    },
                    "reciproque-thales": {
                        title: "Réciproque de Thalès",
                        content: {
                            "theorem": "Soit deux droites (AB) et (AC) sécantes en A, avec M sur (AB) et N sur (AC).\n\nSi AM/AB = AN/AC et si les points A, B, M d'une part et A, C, N d'autre part sont alignés dans le même ordre, alors les droites (MN) et (BC) sont parallèles.",
                            "example": "Soit un triangle ABC avec AB = 12 cm, AC = 9 cm.\n\nSur le côté [AB], on place un point M tel que AM = 8 cm.\nSur le côté [AC], on place un point N tel que AN = 6 cm.\n\nLes droites (MN) et (BC) sont-elles parallèles ?\nOn calcule : AM/AB = 8/12 = 2/3 et AN/AC = 6/9 = 2/3\n\nComme AM/AB = AN/AC, d'après la réciproque du théorème de Thalès, les droites (MN) et (BC) sont parallèles."
                        },
                        media: []
                    },
                    "exercices": {
                        title: "Exercices d'application",
                        content: {
                            "exercise": "Exercice 1 (Pythagore):\nUn triangle ABC a pour dimensions AB = 6 cm, AC = 8 cm et BC = 10 cm.\nCe triangle est-il rectangle ? Si oui, en quel point ?\n\nExercice 2 (Thalès):\nSur la figure ci-dessous, les droites (MN) et (BC) sont parallèles.\nOn donne : AB = 12 cm, AM = 3 cm, AC = 10 cm.\nCalculer AN.\n\nExercice 3 (Problème combiné):\nUne échelle de 5 m est appuyée contre un mur. Le pied de l'échelle est à 2 m du mur.\n1. À quelle hauteur le sommet de l'échelle touche-t-il le mur ?\n2. Si on écarte le pied de l'échelle de 0,5 m supplémentaire, à quelle hauteur montera-t-elle alors ?",
                            "exercise-solution": "Solution Exercice 1:\nOn calcule :\nBC² = 10² = 100\nAB² + AC² = 6² + 8² = 36 + 64 = 100\nComme BC² = AB² + AC², d'après la réciproque du théorème de Pythagore, le triangle ABC est rectangle en A.\n\nSolution Exercice 2:\nD'après le théorème de Thalès :\nAM/AB = AN/AC\n3/12 = AN/10\nAN = (3 × 10)/12 = 30/12 = 2,5 cm\n\nSolution Exercice 3:\n1. On utilise le théorème de Pythagore :\nHauteur² = 5² - 2² = 25 - 4 = 21\nHauteur = √21 ≈ 4,58 m\n\n2. Nouvelle distance du pied au mur : 2 + 0,5 = 2,5 m\nNouvelle hauteur² = 5² - 2,5² = 25 - 6,25 = 18,75\nNouvelle hauteur = √18,75 ≈ 4,33 m"
                        },
                        media: []
                    },
                    "resume": {
                        title: "Résumé et Récapitulatif",
                        content: {
                            "summary": "Fiche de synthèse:\n\n- Théorème de Pythagore: Si un triangle est rectangle, alors le carré de l'hypoténuse est égal à la somme des carrés des deux autres côtés.\n- Réciproque de Pythagore: Si dans un triangle, le carré du plus grand côté est égal à la somme des carrés des deux autres côtés, alors ce triangle est rectangle.\n- Théorème de Thalès: Dans une configuration avec des droites parallèles, les rapports des longueurs des segments sont égaux.\n- Réciproque de Thalès: Si les rapports des longueurs des segments sont égaux et si les points sont alignés dans le même ordre, alors les droites sont parallèles.\n\nMéthodologie pour résoudre un problème :\n1. Identifier la configuration (triangle rectangle ou configuration de Thalès)\n2. Énoncer le théorème ou la réciproque applicable\n3. Écrire l'égalité correspondante\n4. Remplacer par les valeurs connues\n5. Résoudre l'équation pour trouver la valeur inconnue\n6. Conclure en interprétant le résultat"
                        },
                        media: []
                    },
                    "devoir-maison": {
                        title: "Devoir Maison",
                        content: {
                            "homework": "Exercices à rendre:\n\nExercice 1: Un triangle a pour côtés 7 cm, 8 cm et 11 cm. Est-il rectangle ? Justifier.\n\nExercice 2: Dans un triangle ABC, on place M sur [AB] et N sur [AC] tels que AM = 4 cm, AB = 10 cm, AC = 15 cm. Les droites (MN) et (BC) sont parallèles. Calculer AN.\n\nExercice 3: Une tour est observée par deux personnes situées à 50 m l'une de l'autre. La première voit le sommet sous un angle de 45° et la seconde sous un angle de 30°. Calculer la hauteur de la tour.\n\nProblème: Un bateau quitte le port et navigue 8 km vers l'est, puis 6 km vers le nord. Quelle distance le sépare alors du port ? S'il veut revenir directement au port, quelle distance devra-t-il parcourir ?\n\nDate de rendu: 15 novembre 2025\n\nConsignes: Rédigez soigneusement avec toutes les étapes de raisonnement. Les calculs doivent être détaillés."
                        },
                        media: []
                    }
                }
            };

            // Charger les informations de l'enseignant
            function loadTeacherInfo() {
                document.getElementById('school-name').value = courseData.teacherInfo.schoolName;
                document.getElementById('inspection').value = courseData.teacherInfo.inspection;
                document.getElementById('dre').value = courseData.teacherInfo.dre;
                document.getElementById('teacher-name').value = courseData.teacherInfo.teacherName;
                document.getElementById('school-year').value = courseData.teacherInfo.schoolYear;
                document.getElementById('class').value = courseData.teacherInfo.class;
                document.getElementById('boys-count').value = courseData.teacherInfo.boysCount;
                document.getElementById('girls-count').value = courseData.teacherInfo.girlsCount;
                document.getElementById('teacher-phone').value = courseData.teacherInfo.teacherPhone;
                document.getElementById('teacher-email').value = courseData.teacherInfo.teacherEmail;
            }

            // Sauvegarder les informations de l'enseignant
            function saveTeacherInfo() {
                courseData.teacherInfo.schoolName = document.getElementById('school-name').value;
                courseData.teacherInfo.inspection = document.getElementById('inspection').value;
                courseData.teacherInfo.dre = document.getElementById('dre').value;
                courseData.teacherInfo.teacherName = document.getElementById('teacher-name').value;
                courseData.teacherInfo.schoolYear = document.getElementById('school-year').value;
                courseData.teacherInfo.class = document.getElementById('class').value;
                courseData.teacherInfo.boysCount = parseInt(document.getElementById('boys-count').value);
                courseData.teacherInfo.girlsCount = parseInt(document.getElementById('girls-count').value);
                courseData.teacherInfo.teacherPhone = document.getElementById('teacher-phone').value;
                courseData.teacherInfo.teacherEmail = document.getElementById('teacher-email').value;
            }

            // Éditeur de texte enrichi
            const editor = document.getElementById('editor-content');
            const boldBtn = document.getElementById('bold-btn');
            const italicBtn = document.getElementById('italic-btn');
            const underlineBtn = document.getElementById('underline-btn');
            const strikeBtn = document.getElementById('strike-btn');
            const clearFormatBtn = document.getElementById('clear-format');
            const colorOptions = document.querySelectorAll('.color-option');

            // Fonctions pour la mise en forme
            function formatText(command, value = null) {
                document.execCommand(command, false, value);
                editor.focus();
            }

            boldBtn.addEventListener('click', () => formatText('bold'));
            italicBtn.addEventListener('click', () => formatText('italic'));
            underlineBtn.addEventListener('click', () => formatText('underline'));
            strikeBtn.addEventListener('click', () => formatText('strikeThrough'));
            
            clearFormatBtn.addEventListener('click', () => {
                formatText('removeFormat');
                formatText('unlink');
            });

            colorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const color = option.dataset.color;
                    formatText('foreColor', color);
                });
            });

            // Gestion de l'upload de médias
            const mediaUploadArea = document.getElementById('media-upload-area');
            const mediaFileInput = document.getElementById('media-file-input');
            const mediaPreview = document.getElementById('media-preview');
            const youtubeUrlInput = document.getElementById('youtube-url');
            const addYoutubeBtn = document.getElementById('add-youtube');
            
            mediaUploadArea.addEventListener('click', function() {
                mediaFileInput.click();
            });
            
            mediaUploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.background = '#e8f4fc';
            });
            
            mediaUploadArea.addEventListener('dragleave', function() {
                this.style.background = '';
            });
            
            mediaUploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.background = '';
                
                const files = e.dataTransfer.files;
                handleMediaFiles(files);
            });
            
            mediaFileInput.addEventListener('change', function() {
                handleMediaFiles(this.files);
            });
            
            function handleMediaFiles(files) {
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const mediaItem = document.createElement('div');
                        mediaItem.className = 'media-item';
                        
                        if (file.type.startsWith('image/')) {
                            mediaItem.innerHTML = `
                                <img src="${e.target.result}" alt="${file.name}">
                                <div class="remove-media">&times;</div>
                            `;
                            
                            // Sauvegarder l'image dans les données du cours
                            const currentChapter = document.getElementById('chapter-select').value;
                            if (!courseData.chapters[currentChapter].media) {
                                courseData.chapters[currentChapter].media = [];
                            }
                            courseData.chapters[currentChapter].media.push({
                                type: 'image',
                                name: file.name,
                                data: e.target.result
                            });
                        } else if (file.type.startsWith('video/')) {
                            mediaItem.innerHTML = `
                                <video controls>
                                    <source src="${e.target.result}" type="${file.type}">
                                </video>
                                <div class="remove-media">&times;</div>
                            `;
                        } else if (file.type.startsWith('audio/')) {
                            mediaItem.innerHTML = `
                                <audio controls>
                                    <source src="${e.target.result}" type="${file.type}">
                                </audio>
                                <div class="remove-media">&times;</div>
                            `;
                        }
                        
                        mediaPreview.appendChild(mediaItem);
                        
                        // Ajouter l'événement pour supprimer le média
                        mediaItem.querySelector('.remove-media').addEventListener('click', function() {
                            mediaItem.remove();
                        });
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
            
            // Ajouter une vidéo YouTube
            addYoutubeBtn.addEventListener('click', function() {
                const youtubeUrl = youtubeUrlInput.value.trim();
                if (youtubeUrl) {
                    addYoutubeVideo(youtubeUrl);
                    youtubeUrlInput.value = '';
                }
            });
            
            function addYoutubeVideo(url) {
                // Extraire l'ID de la vidéo YouTube
                const videoId = extractYoutubeId(url);
                if (!videoId) {
                    alert("URL YouTube invalide");
                    return;
                }
                
                const mediaItem = document.createElement('div');
                mediaItem.className = 'media-item';
                mediaItem.innerHTML = `
                    <div class="youtube-thumbnail" data-video-id="${videoId}">
                        <i class="fab fa-youtube"></i>
                        <div class="remove-media">&times;</div>
                    </div>
                `;
                
                mediaPreview.appendChild(mediaItem);
                
                // Ajouter l'événement pour ouvrir la vidéo en plein écran
                mediaItem.querySelector('.youtube-thumbnail').addEventListener('click', function() {
                    const videoId = this.dataset.videoId;
                    openYoutubeModal(videoId);
                });
                
                // Ajouter l'événement pour supprimer le média
                mediaItem.querySelector('.remove-media').addEventListener('click', function(e) {
                    e.stopPropagation();
                    mediaItem.remove();
                });
            }
            
            function extractYoutubeId(url) {
                const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
                const match = url.match(regExp);
                return (match && match[7].length === 11) ? match[7] : false;
            }
            
            // Modal YouTube
            const youtubeModal = document.getElementById('youtube-modal');
            const youtubePlayer = document.getElementById('youtube-player');
            const closeYoutubeBtn = document.getElementById('close-youtube');
            
            function openYoutubeModal(videoId) {
                youtubePlayer.src = `https://www.youtube.com/embed/${videoId}`;
                youtubeModal.style.display = 'flex';
            }
            
            closeYoutubeBtn.addEventListener('click', function() {
                youtubeModal.style.display = 'none';
                youtubePlayer.src = '';
            });
            
            youtubeModal.addEventListener('click', function(e) {
                if (e.target === youtubeModal) {
                    youtubeModal.style.display = 'none';
                    youtubePlayer.src = '';
                }
            });
            
            // Gestion des types de contenu
            const contentTypeButtons = document.querySelectorAll('.content-type-btn');
            let activeContentType = 'problem-situation';
            
            contentTypeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    contentTypeButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    activeContentType = this.dataset.type;
                    
                    // Charger le contenu correspondant au type sélectionné
                    const currentChapter = document.getElementById('chapter-select').value;
                    if (courseData.chapters[currentChapter] && courseData.chapters[currentChapter].content[activeContentType]) {
                        editor.innerHTML = courseData.chapters[currentChapter].content[activeContentType];
                    } else {
                        editor.innerHTML = '';
                    }
                });
            });
            
            // Navigation entre les chapitres
            document.getElementById('chapter-select').addEventListener('change', function() {
                const chapterId = this.value;
                loadChapter(chapterId);
            });
            
            // Navigation via la sidebar
            document.querySelectorAll('#chapters-list a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const chapterId = this.dataset.chapter;
                    document.getElementById('chapter-select').value = chapterId;
                    loadChapter(chapterId);
                });
            });
            
            function loadChapter(chapterId) {
                const chapter = courseData.chapters[chapterId];
                if (!chapter) return;
                
                document.getElementById('chapter-title').value = chapter.title;
                
                // Charger le premier type de contenu disponible
                const firstContentType = Object.keys(chapter.content)[0];
                if (firstContentType) {
                    editor.innerHTML = chapter.content[firstContentType];
                    
                    // Activer le bouton correspondant
                    contentTypeButtons.forEach(btn => {
                        if (btn.dataset.type === firstContentType) {
                            btn.classList.add('active');
                            activeContentType = firstContentType;
                        } else {
                            btn.classList.remove('active');
                        }
                    });
                }
                
                // Charger les médias
                mediaPreview.innerHTML = '';
                if (chapter.media && chapter.media.length > 0) {
                    chapter.media.forEach(media => {
                        if (media.type === 'image') {
                            const mediaItem = document.createElement('div');
                            mediaItem.className = 'media-item';
                            mediaItem.innerHTML = `
                                <img src="${media.data}" alt="${media.name}">
                                <div class="remove-media">&times;</div>
                            `;
                            mediaPreview.appendChild(mediaItem);
                            
                            // Ajouter l'événement pour supprimer le média
                            mediaItem.querySelector('.remove-media').addEventListener('click', function() {
                                mediaItem.remove();
                            });
                        }
                    });
                }
                
                // Mettre à jour l'aperçu
                updatePreview();
            }
            
            // Mise à jour de l'aperçu
            document.getElementById('update-chapter').addEventListener('click', function() {
                const chapterId = document.getElementById('chapter-select').value;
                const content = editor.innerHTML;
                
                // Sauvegarder le contenu
                if (!courseData.chapters[chapterId].content) {
                    courseData.chapters[chapterId].content = {};
                }
                courseData.chapters[chapterId].content[activeContentType] = content;
                
                updatePreview();
            });
            
            function updatePreview() {
                const chapterId = document.getElementById('chapter-select').value;
                const chapter = courseData.chapters[chapterId];
                const preview = document.getElementById('course-preview');
                
                if (!chapter) return;
                
                // Déterminer la classe CSS en fonction du type de contenu
                const contentClasses = {
                    'problem-situation': 'problem-situation',
                    'situation-solution': 'situation-solution',
                    'prerequisites': 'prerequisites',
                    'prerequisites-check': 'prerequisites-check',
                    'general-objectives': 'general-objectives',
                    'specific-objectives': 'specific-objectives',
                    'skills': 'skills',
                    'lesson-theme': 'lesson-theme',
                    'lesson-title': 'lesson-title',
                    'vocabulary': 'vocabulary',
                    'definition': 'definition',
                    'theorem': 'theorem',
                    'demonstration': 'demonstration',
                    'proof': 'proof',
                    'property': 'property',
                    'reciprocal': 'reciprocal',
                    'method-points': 'method-points',
                    'remark': 'remark',
                    'activity': 'activity',
                    'activity-solution': 'activity-solution',
                    'exercise': 'exercise',
                    'exercise-solution': 'exercise-solution',
                    'theorem': 'theorem',
                    'formula': 'formula',
                    'example': 'example',
                    'summary': 'summary',
                    'homework': 'homework'
                };
                
                const contentIcons = {
                    'problem-situation': 'puzzle-piece',
                    'situation-solution': 'lightbulb',
                    'prerequisites': 'list-check',
                    'prerequisites-check': 'check-double',
                    'general-objectives': 'bullseye',
                    'specific-objectives': 'bullseye',
                    'skills': 'graduation-cap',
                    'lesson-theme': 'palette',
                    'lesson-title': 'heading',
                    'vocabulary': 'book',
                    'definition': 'book-open',
                    'example': 'lightbulb',
                    'theorem': 'square-root-alt',
                    'demonstration': 'chalkboard-teacher',
                    'proof': 'tasks',
                    'property': 'shapes',
                    'reciprocal': 'exchange-alt',
                    'method-points': 'clipboard-list',
                    'remark': 'comment',
                    'activity': 'tasks',
                    'activity-solution': 'check-circle',
                    'exercise': 'pencil-alt',
                    'exercise-solution': 'check-double',
                    'theorem': 'graduation-cap',
                    'formula': 'square-root-alt',
                    'example': 'lightbulb',
                    'summary': 'list-alt',
                    'homework': 'tasks'
                };
                
                const contentTitles = {
                    'problem-situation': 'Problème pratique',
                    'situation-solution': 'Solution de la situation problème',
                    'prerequisites': 'Prérequis',
                    'prerequisites-check': 'Vérification des prérequis',
                    'general-objectives': 'Objectifs généraux',
                    'specific-objectives': 'Objectifs spécifiques',
                    'skills': 'Compétences visées',
                    'lesson-theme': 'Thème de la leçon',
                    'lesson-title': 'Titre de la leçon',
                    'vocabulary': 'Vocabulaire',
                    'definition': 'Définition',
                    'example': 'Exemple',
                    'theorem': 'Énoncé du théorème',
                    'demonstration': 'Démonstration',
                    'proof': 'Preuve',
                    'property': 'Propriété',
                    'reciprocal': 'Réciproque de propriété',
                    'method-points': 'Points méthode',
                    'remark': 'Remarque',
                    'activity': 'Activité pédagogique',
                    'activity-solution': 'Solution de l\'activité',
                    'exercise': 'Exercice',
                    'exercise-solution': 'Solution de l\'exercice',
                    'theorem': 'Énoncé du théorème',
                    'formula': 'Formule',
                    'example': 'Exemple',
                    'summary': 'Fiche de synthèse',
                    'homework': 'Exercices à rendre'
                };
                
                let previewHTML = `<div class="chapter">
                    <h2><i class="fas fa-question-circle"></i> ${chapter.title}</h2>
                    <div class="chapter-content">`;
                
                // Ajouter tous les contenus du chapitre
                for (const [contentType, content] of Object.entries(chapter.content)) {
                    const contentClass = contentClasses[contentType] || 'problem-situation';
                    const contentIcon = contentIcons[contentType] || 'puzzle-piece';
                    const contentTitle = contentTitles[contentType] || 'Contenu';
                    
                    if (contentType === 'formula') {
                        previewHTML += `
                            <div class="${contentClass}">
                                ${content.replace(/\n/g, '<br>')}
                            </div>
                        `;
                    } else {
                        previewHTML += `
                            <div class="${contentClass}">
                                <h3><i class="fas fa-${contentIcon}"></i> ${contentTitle}</h3>
                                ${content}
                            </div>
                        `;
                    }
                }
                
                // Ajouter les médias
                if (chapter.media && chapter.media.length > 0) {
                    previewHTML += `<div class="media-container">`;
                    chapter.media.forEach(media => {
                        if (media.type === 'image') {
                            previewHTML += `<img src="${media.data}" alt="${media.name}" style="max-width: 100%; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">`;
                        }
                    });
                    previewHTML += `</div>`;
                }
                
                previewHTML += `</div></div>`;
                preview.innerHTML = previewHTML;
            }
            
            // Initialiser l'aperçu
            loadChapter('situation-probleme');
            loadTeacherInfo();
            
            // Fonctionnalités des boutons
            document.getElementById('new-course').addEventListener('click', function() {
                if (confirm('Créer un nouveau cours ? Les modifications non sauvegardées seront perdues.')) {
                    document.getElementById('course-title').value = 'Nouveau cours';
                    document.getElementById('course-description').value = 'Description du cours';
                    document.getElementById('chapter-title').value = 'Premier chapitre';
                    editor.innerHTML = 'Contenu du chapitre...';
                    mediaPreview.innerHTML = '';
                    document.getElementById('course-preview').innerHTML = '<p>Prévisualisation du cours</p>';
                    
                    // Réinitialiser les données
                    courseData = {
                        title: "Nouveau cours",
                        description: "Description du cours",
                        teacherInfo: {
                            schoolName: "",
                            inspection: "",
                            dre: "",
                            teacherName: "",
                            schoolYear: "",
                            class: "",
                            boysCount: 0,
                            girlsCount: 0,
                            teacherPhone: "",
                            teacherEmail: ""
                        },
                        chapters: {
                            "premier-chapitre": {
                                title: "Premier chapitre",
                                content: {},
                                media: []
                            }
                        }
                    };
                    
                    // Mettre à jour le sélecteur de chapitres
                    const chapterSelect = document.getElementById('chapter-select');
                    chapterSelect.innerHTML = '<option value="premier-chapitre">Premier chapitre</option>';
                    
                    // Mettre à jour la liste des chapitres dans la sidebar
                    const chaptersList = document.getElementById('chapters-list');
                    chaptersList.innerHTML = '<li><a href="#" data-chapter="premier-chapitre"><i class="fas fa-angle-right"></i> Premier chapitre</a></li>';
                    
                    // Ajouter l'événement de clic
                    chaptersList.querySelector('a').addEventListener('click', function(e) {
                        e.preventDefault();
                        document.getElementById('chapter-select').value = 'premier-chapitre';
                        loadChapter('premier-chapitre');
                    });
                    
                    loadTeacherInfo();
                }
            });
            
            document.getElementById('save-course').addEventListener('click', function() {
                saveTeacherInfo();
                courseData.title = document.getElementById('course-title').value;
                courseData.description = document.getElementById('course-description').value;
                
                // Sauvegarder dans le stockage local
                localStorage.setItem('savedCourse', JSON.stringify(courseData));
                alert('Cours sauvegardé avec succès !');
            });
            
            document.getElementById('load-course').addEventListener('click', function() {
                const savedCourse = localStorage.getItem('savedCourse');
                if (savedCourse) {
                    if (confirm('Charger le cours sauvegardé ? Les modifications non sauvegardées seront perdues.')) {
                        courseData = JSON.parse(savedCourse);
                        
                        // Mettre à jour l'interface
                        document.getElementById('course-title').value = courseData.title;
                        document.getElementById('course-description').value = courseData.description;
                        loadTeacherInfo();
                        
                        // Mettre à jour le sélecteur de chapitres
                        const chapterSelect = document.getElementById('chapter-select');
                        chapterSelect.innerHTML = '';
                        
                        // Mettre à jour la liste des chapitres dans la sidebar
                        const chaptersList = document.getElementById('chapters-list');
                        chaptersList.innerHTML = '';
                        
                        for (const [chapterId, chapter] of Object.entries(courseData.chapters)) {
                            // Ajouter au select
                            const option = document.createElement('option');
                            option.value = chapterId;
                            option.textContent = chapter.title;
                            chapterSelect.appendChild(option);
                            
                            // Ajouter à la sidebar
                            const newItem = document.createElement('li');
                            newItem.innerHTML = `<a href="#" data-chapter="${chapterId}"><i class="fas fa-angle-right"></i> ${chapter.title}</a>`;
                            chaptersList.appendChild(newItem);
                            
                            // Ajouter l'événement de clic
                            newItem.querySelector('a').addEventListener('click', function(e) {
                                e.preventDefault();
                                document.getElementById('chapter-select').value = chapterId;
                                loadChapter(chapterId);
                            });
                        }
                        
                        // Charger le premier chapitre
                        const firstChapterId = Object.keys(courseData.chapters)[0];
                        if (firstChapterId) {
                            chapterSelect.value = firstChapterId;
                            loadChapter(firstChapterId);
                        }
                        
                        alert('Cours chargé avec succès !');
                    }
                } else {
                    alert('Aucun cours sauvegardé trouvé.');
                }
            });
            
            document.getElementById('export-json').addEventListener('click', function() {
                saveTeacherInfo();
                courseData.title = document.getElementById('course-title').value;
                courseData.description = document.getElementById('course-description').value;
                
                const dataStr = JSON.stringify(courseData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = courseData.title.replace(/\s+/g, '_') + '.json';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            });
            
            document.getElementById('import-json').addEventListener('click', function() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                
                input.onchange = e => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        try {
                            const importedData = JSON.parse(e.target.result);
                            
                            if (confirm('Importer ce cours ? Les modifications non sauvegardées seront perdues.')) {
                                courseData = importedData;
                                
                                // Mettre à jour l'interface
                                document.getElementById('course-title').value = courseData.title;
                                document.getElementById('course-description').value = courseData.description;
                                loadTeacherInfo();
                                
                                // Mettre à jour le sélecteur de chapitres
                                const chapterSelect = document.getElementById('chapter-select');
                                chapterSelect.innerHTML = '';
                                
                                // Mettre à jour la liste des chapitres dans la sidebar
                                const chaptersList = document.getElementById('chapters-list');
                                chaptersList.innerHTML = '';
                                
                                for (const [chapterId, chapter] of Object.entries(courseData.chapters)) {
                                    // Ajouter au select
                                    const option = document.createElement('option');
                                    option.value = chapterId;
                                    option.textContent = chapter.title;
                                    chapterSelect.appendChild(option);
                                    
                                    // Ajouter à la sidebar
                                    const newItem = document.createElement('li');
                                    newItem.innerHTML = `<a href="#" data-chapter="${chapterId}"><i class="fas fa-angle-right"></i> ${chapter.title}</a>`;
                                    chaptersList.appendChild(newItem);
                                    
                                    // Ajouter l'événement de clic
                                    newItem.querySelector('a').addEventListener('click', function(e) {
                                        e.preventDefault();
                                        document.getElementById('chapter-select').value = chapterId;
                                        loadChapter(chapterId);
                                    });
                                }
                                
                                // Charger le premier chapitre
                                const firstChapterId = Object.keys(courseData.chapters)[0];
                                if (firstChapterId) {
                                    chapterSelect.value = firstChapterId;
                                    loadChapter(firstChapterId);
                                }
                                
                                alert('Cours importé avec succès !');
                            }
                        } catch (error) {
                            alert('Erreur lors de l\'importation du fichier : ' + error.message);
                        }
                    };
                    
                    reader.readAsText(file);
                };
                
                input.click();
            });
            
            document.getElementById('add-chapter').addEventListener('click', function(e) {
                e.preventDefault();
                const chapterName = prompt('Nom du nouveau chapitre :');
                if (chapterName) {
                    const chapterId = chapterName.toLowerCase().replace(/\s+/g, '-');
                    
                    // Ajouter aux données
                    courseData.chapters[chapterId] = {
                        title: chapterName,
                        content: {},
                        media: []
                    };
                    
                    // Ajouter au select
                    const option = document.createElement('option');
                    option.value = chapterId;
                    option.textContent = chapterName;
                    document.getElementById('chapter-select').appendChild(option);
                    
                    // Ajouter à la sidebar
                    const chaptersList = document.getElementById('chapters-list');
                    const newItem = document.createElement('li');
                    newItem.innerHTML = `<a href="#" data-chapter="${chapterId}"><i class="fas fa-angle-right"></i> ${chapterName}</a>`;
                    chaptersList.appendChild(newItem);
                    
                    // Ajouter l'événement de clic
                    newItem.querySelector('a').addEventListener('click', function(e) {
                        e.preventDefault();
                        document.getElementById('chapter-select').value = chapterId;
                        loadChapter(chapterId);
                    });
                }
            });
            
            // Gestion des nouveaux outils
            document.getElementById('add-prerequisites').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('prerequisites', "Listez les prérequis nécessaires pour cette leçon...");
            });
            
            document.getElementById('add-prerequisites-check').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('prerequisites-check', "Ajoutez ici une activité de vérification des prérequis...");
            });
            
            document.getElementById('add-problem-situation').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('problem-situation', "Décrivez la situation problème qui introduira la leçon...");
            });
            
            document.getElementById('add-solution-situation').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('situation-solution', "Proposez la solution à la situation problème...");
            });
            
            document.getElementById('add-general-objectives').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('general-objectives', "Définissez les objectifs généraux de cette leçon...");
            });
            
            document.getElementById('add-specific-objectives').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('specific-objectives', "Listez les objectifs spécifiques de cette leçon...");
            });
            
            document.getElementById('add-skills').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('skills', "Précisez les compétences visées par cette leçon...");
            });
            
            document.getElementById('add-lesson-theme').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('lesson-theme', "Indiquez le thème de la leçon...");
            });	
			document.getElementById('add-lesson-title').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('lesson-title', "Indiquez le titre de la leçon...");
            });
            
            document.getElementById('add-vocabulary').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('vocabulary', "Listez le vocabulaire spécifique à cette leçon...");
            });
            
            document.getElementById('add-definition').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('definition', "Ajoutez une définition...");
            });
            
            document.getElementById('add-example').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('example', "Donnez un exemple illustratif...");
            });
            
            document.getElementById('add-theorem').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('theorem', "Énoncez le théorème...");
            });
            
            document.getElementById('add-demonstration').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('demonstration', "Rédigez la démonstration...");
            });
            
            document.getElementById('add-proof').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('proof', "Présentez la preuve...");
            });
            
            document.getElementById('add-property').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('property', "Énoncez la propriété...");
            });
            
            document.getElementById('add-reciprocal').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('reciprocal', "Énoncez la réciproque de la propriété...");
            });
            
            document.getElementById('add-method-points').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('method-points', "Listez les points méthode importants...");
            });
            
            document.getElementById('add-remark').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('remark', "Ajoutez une remarque...");
            });
            
            document.getElementById('add-application-exercise').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('exercise', "Rédigez un exercice d'application...");
            });
            
            document.getElementById('add-exercise-solution').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('exercise-solution', "Proposez la solution de l'exercice...");
            });
            
            document.getElementById('add-activity').addEventListener('click', function(e) {
                e.preventDefault();
                activateContentType('activity', "Concevez une activité pédagogique...");
            });
            
            document.getElementById('add-media').addEventListener('click', function(e) {
                e.preventDefault();
                mediaFileInput.click();
            });
            
            function activateContentType(type, placeholder) {
                // Activer le bouton correspondant
                contentTypeButtons.forEach(btn => {
                    if (btn.dataset.type === type) {
                        btn.classList.add('active');
                        activeContentType = type;
                    } else {
                        btn.classList.remove('active');
                    }
                });
                
                // Vérifier si ce type de contenu existe déjà
                const currentChapter = document.getElementById('chapter-select').value;
                if (courseData.chapters[currentChapter] && courseData.chapters[currentChapter].content[type]) {
                    editor.innerHTML = courseData.chapters[currentChapter].content[type];
                } else {
                    editor.innerHTML = placeholder;
                }
            }
            
            // Exportation PDF
            document.getElementById('export-pdf').addEventListener('click', function(e) {
                e.preventDefault();
                showExportModal('pdf');
            });
            
            // Exportation HTML
            document.getElementById('export-html').addEventListener('click', function(e) {
                e.preventDefault();
                showExportModal('html');
            });
            
            function showExportModal(format) {
                const modal = document.getElementById('export-modal');
                modal.style.display = 'flex';
                
                // Configurer l'exportation selon le format
                document.getElementById('confirm-export').dataset.format = format;
                
                // Afficher/masquer les options spécifiques
                if (format === 'pdf') {
                    document.getElementById('export-all-chapters').checked = true;
                    document.getElementById('chapter-selection').style.display = 'none';
                } else {
                    document.getElementById('chapter-selection').style.display = 'block';
                }
            }
            
            // Gestion de la modal d'exportation
            document.getElementById('cancel-export').addEventListener('click', function() {
                document.getElementById('export-modal').style.display = 'none';
            });
            
            document.getElementById('export-all-chapters').addEventListener('change', function() {
                const chapterSelection = document.getElementById('chapter-selection');
                chapterSelection.style.display = this.checked ? 'none' : 'block';
            });
            
            document.getElementById('confirm-export').addEventListener('click', function() {
                const format = this.dataset.format;
                const includeTitle = document.getElementById('export-title').checked;
                const includeDescription = document.getElementById('export-description').checked;
                const exportAllChapters = document.getElementById('export-all-chapters').checked;
                
                let chaptersToExport = [];
                
                if (exportAllChapters) {
                    chaptersToExport = Object.keys(courseData.chapters);
                } else {
                    const selectedOptions = document.getElementById('export-chapters').selectedOptions;
                    for (let option of selectedOptions) {
                        chaptersToExport.push(option.value);
                    }
                }
                
                if (format === 'pdf') {
                    exportToPDF(includeTitle, includeDescription, chaptersToExport);
                } else if (format === 'html') {
                    exportToHTML(includeTitle, includeDescription, chaptersToExport);
                }
                
                document.getElementById('export-modal').style.display = 'none';
            });
            
            function exportToPDF(includeTitle, includeDescription, chaptersToExport) {
                // Préparer le contenu pour l'exportation PDF
                const content = prepareExportContent(includeTitle, includeDescription, chaptersToExport);
                
                // Configuration pour html2pdf
                const options = {
                    margin: 10,
                    filename: courseData.title.replace(/\s+/g, '_') + '.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                };
                
                // Créer un élément temporaire pour le contenu
                const element = document.createElement('div');
                element.innerHTML = content;
                
                // Générer le PDF
                html2pdf().set(options).from(element).save();
            }
            
            function exportToHTML(includeTitle, includeDescription, chaptersToExport) {
                // Préparer le contenu pour l'exportation HTML
                const content = prepareExportContent(includeTitle, includeDescription, chaptersToExport);
                
                // Créer un blob avec le contenu HTML
                const blob = new Blob([`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>${courseData.title}</title><style>body{font-family:Arial,sans-serif;line-height:1.6;margin:20px;}h1,h2,h3{color:#2c3e50;}div{margin-bottom:20px;}</style></head><body>${content}</body></html>`], { type: 'text/html' });
                
                // Créer un lien de téléchargement
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = courseData.title.replace(/\s+/g, '_') + '.html';
                a.click();
            }
            
            function prepareExportContent(includeTitle, includeDescription, chaptersToExport) {
                let content = '';
                
                // Ajouter le titre si demandé
                if (includeTitle) {
                    content += `<h1>${courseData.title}</h1>`;
                }
                
                // Ajouter la description si demandée
                if (includeDescription) {
                    content += `<p><em>${courseData.description}</em></p>`;
                }
                
                // Ajouter les informations de l'enseignant
                content += `<div class="teacher-info">
                    <h3>Informations de l'enseignant</h3>
                    <p><strong>Établissement:</strong> ${courseData.teacherInfo.schoolName}</p>
                    <p><strong>Enseignant:</strong> ${courseData.teacherInfo.teacherName}</p>
                    <p><strong>Classe:</strong> ${courseData.teacherInfo.class}</p>
                    <p><strong>Année scolaire:</strong> ${courseData.teacherInfo.schoolYear}</p>
                </div>`;
                
                // Ajouter les chapitres sélectionnés
                for (const chapterId of chaptersToExport) {
                    const chapter = courseData.chapters[chapterId];
                    if (!chapter) continue;
                    
                    content += `<div class="chapter">
                        <h2>${chapter.title}</h2>`;
                    
                    for (const [contentType, chapterContent] of Object.entries(chapter.content)) {
                        content += `<div class="content-${contentType}">
                            ${chapterContent}
                        </div>`;
                    }
                    
                    // Ajouter les médias
                    if (chapter.media && chapter.media.length > 0) {
                        content += `<div class="media-container">`;
                        chapter.media.forEach(media => {
                            if (media.type === 'image') {
                                content += `<img src="${media.data}" alt="${media.name}" style="max-width: 100%; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">`;
                            }
                        });
                        content += `</div>`;
                    }
                    
                    content += `</div>`;
                }
                
                return content;
            }
            
            // Fonctionnalité plein écran pour l'aperçu
            const fullscreenPreviewBtn = document.getElementById('fullscreen-preview');
            const fullscreenModal = document.getElementById('fullscreen-modal');
            const fullscreenContent = document.getElementById('fullscreen-content');
            const closeFullscreenBtn = document.getElementById('close-fullscreen');
            
            fullscreenPreviewBtn.addEventListener('click', function() {
                // Copier le contenu de l'aperçu dans la modal plein écran
                fullscreenContent.innerHTML = document.getElementById('course-preview').innerHTML;
                
                // Afficher la modal
                fullscreenModal.style.display = 'block';
                
                // Ajouter un style pour améliorer l'affichage en plein écran
                const style = document.createElement('style');
                style.innerHTML = `
                    .fullscreen-modal .chapter {
                        margin-bottom: 40px;
                    }
                    .fullscreen-modal .chapter h2 {
                        font-size: 2rem;
                        margin-bottom: 20px;
                    }
                    .fullscreen-modal .chapter-content {
                        font-size: 1.1rem;
                        line-height: 1.8;
                    }
                    .fullscreen-modal img {
                        max-width: 100%;
                        height: auto;
                        border-radius: 8px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                        margin: 15px 0;
                    }
                `;
                fullscreenContent.appendChild(style);
            });
            
            closeFullscreenBtn.addEventListener('click', function() {
                fullscreenModal.style.display = 'none';
            });
            
            // Fermer la modal en cliquant à l'extérieur du contenu
            fullscreenModal.addEventListener('click', function(e) {
                if (e.target === fullscreenModal) {
                    fullscreenModal.style.display = 'none';
                }
            });
            
            // Initialisation finale
            updatePreview();
        });
    </script>
</body>
</html>
